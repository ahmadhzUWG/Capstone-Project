<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Nick\Desktop\Capstone-Project\code\TaskManager.Tests\Tests\TestViewModels\UserViewModelTests.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System.ComponentModel.DataAnnotations;
using TaskManagerWebsite.ViewModels;

namespace TaskManager.Tests.Tests.TestViewModels
{
    public class UserViewModelTests
    {
        [Fact]
        public void UserViewModel_Properties_CanBeSetAndRetrieved()
        {
            var vm = new UserViewModel
            {
                UserName = &quot;testUser&quot;,
                Email = &quot;user@gmail.com&quot;,
                Password = &quot;password123&quot;,
                ConfirmPassword = &quot;password123&quot;
            };

            Assert.Equal(&quot;testUser&quot;, vm.UserName);
            Assert.Equal(&quot;user@gmail.com&quot;, vm.Email);
            Assert.Equal(&quot;password123&quot;, vm.Password);
            Assert.Equal(&quot;password123&quot;, vm.ConfirmPassword);
        }

        [Fact]
        public void UserViewModel_Validation_PassesForValidModel()
        {
            var vm = new UserViewModel
            {
                UserName = &quot;validUser&quot;,
                Email = &quot;user@example.com&quot;,
                Password = &quot;password123&quot;,
                ConfirmPassword = &quot;password123&quot;
            };

            var results = ValidateModel(vm);
            Assert.Empty(results);
        }

        [Fact]
        public void UserViewModel_Validation_Fails_WhenUserNameMissing()
        {
            var vm = new UserViewModel
            {
                UserName = null,
                Email = &quot;user@example.com&quot;,
                Password = &quot;password123&quot;,
                ConfirmPassword = &quot;password123&quot;
            };

            var results = ValidateModel(vm);
            Assert.Contains(results, r =&gt; r.MemberNames.Contains(&quot;UserName&quot;));
        }

        [Fact]
        public void UserViewModel_Validation_Fails_WhenEmailMissing()
        {
            var vm = new UserViewModel
            {
                UserName = &quot;testUser&quot;,
                Email = null,
                Password = &quot;password123&quot;,
                ConfirmPassword = &quot;password123&quot;
            };

            var results = ValidateModel(vm);
            Assert.Contains(results, r =&gt; r.MemberNames.Contains(&quot;Email&quot;));
        }

        [Fact]
        public void UserViewModel_Validation_Fails_WhenEmailIsInvalid()
        {
            var vm = new UserViewModel
            {
                UserName = &quot;testUser&quot;,
                Email = &quot;notAnEmail&quot;,
                Password = &quot;password123&quot;,
                ConfirmPassword = &quot;password123&quot;
            };

            var results = ValidateModel(vm);
            Assert.Contains(results, r =&gt; r.MemberNames.Contains(&quot;Email&quot;));
        }

        [Fact]
        public void UserViewModel_Validation_Fails_WhenPasswordMissing()
        {
            var vm = new UserViewModel
            {
                UserName = &quot;testUser&quot;,
                Email = &quot;user@example.com&quot;,
                Password = null,
                ConfirmPassword = &quot;password123&quot;
            };

            var results = ValidateModel(vm);
            Assert.Contains(results, r =&gt; r.MemberNames.Contains(&quot;Password&quot;));
        }

        [Fact]
        public void UserViewModel_Validation_Fails_WhenConfirmPasswordMissing()
        {
            var vm = new UserViewModel
            {
                UserName = &quot;testUser&quot;,
                Email = &quot;user@example.com&quot;,
                Password = &quot;password123&quot;,
                ConfirmPassword = null
            };

            var results = ValidateModel(vm);
            Assert.Contains(results, r =&gt; r.MemberNames.Contains(&quot;ConfirmPassword&quot;));
        }

        [Fact]
        public void UserViewModel_Validation_Fails_WhenPasswordsDoNotMatch()
        {
            var vm = new UserViewModel
            {
                UserName = &quot;testUser&quot;,
                Email = &quot;user@example.com&quot;,
                Password = &quot;password123&quot;,
                ConfirmPassword = &quot;differentPassword&quot;
            };

            var results = ValidateModel(vm);
            Assert.Contains(results, r =&gt; r.MemberNames.Contains(&quot;ConfirmPassword&quot;));
        }

        private static List&lt;ValidationResult&gt; ValidateModel(object model)
        {
            var validationResults = new List&lt;ValidationResult&gt;();
            var context = new ValidationContext(model, null, null);
            Validator.TryValidateObject(model, context, validationResults, true);
            return validationResults;
        }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[10,9,10,10,1],[11,13,17,15,1],[19,13,19,51,1],[20,13,20,54,1],[21,13,21,54,1],[22,13,22,61,1],[23,9,23,10,1],[27,9,27,10,1],[28,13,34,15,1],[36,13,36,45,1],[37,13,37,35,1],[38,9,38,10,1],[42,9,42,10,1],[43,13,49,15,1],[51,13,51,45,1],[52,13,52,43,1],[52,43,52,77,1],[52,77,52,79,1],[53,9,53,10,1],[57,9,57,10,1],[58,13,64,15,1],[66,13,66,45,1],[67,13,67,43,1],[67,43,67,74,1],[67,74,67,76,1],[68,9,68,10,1],[72,9,72,10,1],[73,13,79,15,1],[81,13,81,45,1],[82,13,82,43,1],[82,43,82,74,1],[82,74,82,76,1],[83,9,83,10,1],[87,9,87,10,1],[88,13,94,15,1],[96,13,96,45,1],[97,13,97,43,1],[97,43,97,77,1],[97,77,97,79,1],[98,9,98,10,1],[102,9,102,10,1],[103,13,109,15,1],[111,13,111,45,1],[112,13,112,43,1],[112,43,112,84,1],[112,84,112,86,1],[113,9,113,10,1],[117,9,117,10,1],[118,13,124,15,1],[126,13,126,45,1],[127,13,127,43,1],[127,43,127,84,1],[127,84,127,86,1],[128,9,128,10,1],[131,9,131,10,1],[132,13,132,66,1],[133,13,133,68,1],[134,13,134,82,1],[135,13,135,38,1],[136,9,136,10,1]]);
    </script>
  </body>
</html>